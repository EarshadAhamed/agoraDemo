(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){},26:function(e,t,a){"use strict";(function(e){var n=a(30),s=a(6),i=a(7),o=a(13),l=a(9),r=a(8),c=a(0),d=a.n(c),p=a(27),m=a(18),u=a.n(m),g=(a(43),a(22),{1:["span 12/span 24"],2:["span 12/span 12/13/25","span 12/span 12/13/13"],3:["span 6/span 12","span 6/span 12","span 6/span 12/7/19"],4:["span 6/span 12","span 6/span 12","span 6/span 12","span 6/span 12/7/13"],5:["span 3/span 4/13/9","span 3/span 4/13/13","span 3/span 4/13/17","span 3/span 4/13/21","span 9/span 16/10/21"],6:["span 3/span 4/13/7","span 3/span 4/13/11","span 3/span 4/13/15","span 3/span 4/13/19","span 3/span 4/13/23","span 9/span 16/10/21"],7:["span 3/span 4/13/5","span 3/span 4/13/9","span 3/span 4/13/13","span 3/span 4/13/17","span 3/span 4/13/21","span 3/span 4/13/25","span 9/span 16/10/21"]}),h=function(t){Object(l.a)(c,t);var a=Object(r.a)(c);function c(e){var t;return Object(s.a)(this,c),(t=a.call(this,e)).streamInit=function(e,t,a,n){var s={streamID:e,audio:!0,video:!0,screen:!1};switch(t){case"audio-only":s.video=!1;break;case"audience":s.video=!1,s.audio=!1;break;default:case"video":}var i=u.a.createStream(Object(p.merge)(s,n));return i.setVideoProfile(a),i},t.subscribeStreamEvents=function(){var e=Object(o.a)(t);e.client.on("stream-added",function(t){var a=t.stream;console.log("New stream added: "+a.getId()),console.log("At "+(new Date).toLocaleTimeString()),console.log("Subscribe ",a),e.client.subscribe(a,function(e){console.log("Subscribe stream failed",e)})}),e.client.on("peer-leave",function(t){console.log("Peer has left: "+t.uid),console.log((new Date).toLocaleTimeString()),console.log(t),e.removeStream(t.uid)}),e.client.on("stream-subscribed",function(t){var a=t.stream;console.log("Got stream-subscribed event"),console.log((new Date).toLocaleTimeString()),console.log("Subscribe remote stream successfully: "+a.getId()),console.log(t),e.addStream(a)}),e.client.on("stream-removed",function(t){var a=t.stream;console.log("Stream removed: "+a.getId()),console.log((new Date).toLocaleTimeString()),console.log(t),e.removeStream(a.getId())})},t.removeStream=function(e){t.state.streamList.map(function(a,s){if(a.getId()===e){a.close();var i=document.querySelector("#ag-item-"+e);i&&i.parentNode.removeChild(i);var o=Object(n.a)(t.state.streamList);o.splice(s,1),t.setState({streamList:o})}})},t.addStream=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.state.streamList.some(function(t){return t.getId()===e.getId()})||(a?t.setState({streamList:t.state.streamList.concat([e])}):t.setState({streamList:[e].concat(t.state.streamList)}))},t.handleCamera=function(e){e.currentTarget.classList.toggle("off"),t.localStream.isVideoOn()?t.localStream.disableVideo():t.localStream.enableVideo()},t.handleMic=function(e){e.currentTarget.classList.toggle("off"),t.localStream.isAudioOn()?t.localStream.disableAudio():t.localStream.enableAudio()},t.switchDisplay=function(e){e.currentTarget.classList.contains("disabled")||t.state.streamList.length<=1||("pip"===t.state.displayMode?t.setState({displayMode:"tile"}):"tile"===t.state.displayMode?t.setState({displayMode:"pip"}):"share"===t.state.displayMode||console.error("Display Mode can only be tile/pip/share"))},t.hideRemote=function(e){if(!(e.currentTarget.classList.contains("disabled")||t.state.streamList.length<=1)){var a=t.state.streamList[t.state.streamList.length-1].getId();Array.from(document.querySelectorAll(".ag-item:not(#ag-item-".concat(a,")"))).map(function(e){"none"!==e.style.display?e.style.display="none":e.style.display="block"})}},t.handleExit=function(e){if(!e.currentTarget.classList.contains("disabled"))try{t.client&&t.client.unpublish(t.localStream),t.localStream&&t.localStream.close(),t.client&&t.client.leave(function(){console.log("Client succeed to leave.")},function(){console.log("Client failed to leave.")})}finally{t.setState({readyState:!1}),t.client=null,t.localStream=null,window.location.hash=""}},t.client={},t.localStream={},t.shareClient={},t.shareStream={},t.state={displayMode:"pip",streamList:[],readyState:!1},t}return Object(i.a)(c,[{key:"componentWillMount",value:function(){var e=this,t=this.props;this.client=u.a.createClient({mode:t.transcode}),this.client.init(t.appId,function(){console.log("AgoraRTC client initialized"),e.subscribeStreamEvents(),e.client.join(t.appId,t.channel,t.uid,function(a){console.log("User "+a+" join channel successfully"),console.log("At "+(new Date).toLocaleTimeString()),e.localStream=e.streamInit(a,t.attendeeMode,t.videoProfile),e.localStream.init(function(){"audience"!==t.attendeeMode&&(e.addStream(e.localStream,!0),e.client.publish(e.localStream,function(e){console.log("Publish local stream error: "+e)})),e.setState({readyState:!0})},function(t){console.log("getUserMedia failed",t),e.setState({readyState:!0})})})})}},{key:"componentDidMount",value:function(){var t=document.querySelector("#ag-canvas"),a=document.querySelector(".ag-btn-group");t.addEventListener("mousemove",function(){e._toolbarToggle&&clearTimeout(e._toolbarToggle),a.classList.add("active"),e._toolbarToggle=setTimeout(function(){a.classList.remove("active")},2e3)})}},{key:"componentDidUpdate",value:function(){var e=document.querySelector("#ag-canvas");if("pip"===this.state.displayMode){var t=this.state.streamList.length;if(t>4)return void this.setState({displayMode:"tile"});this.state.streamList.map(function(a,n){var s=a.getId(),i=document.querySelector("#ag-item-"+s);i||((i=document.createElement("section")).setAttribute("id","ag-item-"+s),i.setAttribute("class","ag-item"),e.appendChild(i),a.play("ag-item-"+s)),n===t-1?i.setAttribute("style","grid-area: span 12/span 24/13/25"):i.setAttribute("style","grid-area: span 3/span 4/".concat(4+3*n,"/25;\n                    z-index:1;width:calc(100% - 20px);height:calc(100% - 20px)")),a.player.resize&&a.player.resize()})}else if("tile"===this.state.displayMode){var a=this.state.streamList.length;this.state.streamList.map(function(t,n){var s=t.getId(),i=document.querySelector("#ag-item-"+s);i||((i=document.createElement("section")).setAttribute("id","ag-item-"+s),i.setAttribute("class","ag-item"),e.appendChild(i),t.play("ag-item-"+s)),i.setAttribute("style","grid-area: ".concat(g[a][n])),t.player.resize&&t.player.resize()})}else this.state.displayMode}},{key:"componentWillUnmount",value:function(){this.client&&this.client.unpublish(this.localStream),this.localStream&&this.localStream.close(),this.client&&this.client.leave(function(){console.log("Client succeed to leave.")},function(){console.log("Client failed to leave.")})}},{key:"render",value:function(){var e="video"===this.props.attendeeMode?d.a.createElement("span",{onClick:this.handleCamera,className:"ag-btn videoControlBtn",title:"Enable/Disable Video"},d.a.createElement("i",{className:"ag-icon ag-icon-camera"}),d.a.createElement("i",{className:"ag-icon ag-icon-camera-off"})):"",t="audience"!==this.props.attendeeMode?d.a.createElement("span",{onClick:this.handleMic,className:"ag-btn audioControlBtn",title:"Enable/Disable Audio"},d.a.createElement("i",{className:"ag-icon ag-icon-mic"}),d.a.createElement("i",{className:"ag-icon ag-icon-mic-off"})):"",a=(this.switchDisplay,this.state.streamList.length,this.state.streamList.length>4||this.state.displayMode,this.hideRemote,d.a.createElement("span",{onClick:this.handleExit,className:this.state.readyState?"ag-btn exitBtn":"ag-btn exitBtn disabled",title:"Exit"},d.a.createElement("i",{className:"ag-icon ag-icon-leave"})));return d.a.createElement("div",{id:"ag-canvas",style:{display:"grid",gridGap:"10px",alignItems:"center",justifyItems:"center",gridTemplateRows:"repeat(12, auto)",gridTemplateColumns:"repeat(24, auto)"}},d.a.createElement("div",{className:"ag-btn-group"},a,e,t))}}]),c}(d.a.Component);t.a=h}).call(this,a(16))},31:function(e,t,a){e.exports=a(61)},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){e.exports=a.p+"static/media/ag-logo.c9b3e104.png"},40:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAPCAYAAAGega+EAAAABGdBTUEAALGPC/xhBQAAASFJREFUOBHNk71qAkEUhR3jDwGFpLGSCBaCjZB0VoEQErAWHyMvYKFWiiD4LFaWFmmCnW9gmyZlcCBsvqM7G2aDu9p54XDn3HPu3ZnZ3UyGCIJgBG60GIQFa1QV+Qsnuwrc7tcSwAcYgpJ6Jyg750zPaplhuwZ3YK3NzJP60L+zGL6STGhXMhVTTPlIZ2wnIizgNce1yUfIkyvE8q0x5k0d/ZjgUfSy9lTwqv/JTqbUONl0eFXH5xV1uhf0dui5J1fBBmyB5XRj8iEwt9xaGd5zXJNeIQswBGknxeJFA9bkaQ+aOgCxD9EzJxJ6LSicdEuJk0Lx8gbl2NkKLHVW8rmX/UxPnsu2hoUXDOxSmIIf8A4qQH/1J9D3UQczmvW3R/ELvLZ7YNQHvpUAAAAASUVORK5CYII="},41:function(e,t,a){},43:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(25),o=a.n(i),l=a(6),r=a(7),c=a(9),d=a(8),p=a(28),m=a(1),u=(a(36),a(37),a(10)),g=(a(22),{minLength:function(e,t){return e.length<t?1:0},maxLength:function(e,t){return e.length>t?1:0},validChar:function(e){return/^[0-9a-zA-Z\_]+$/.test(e)?0:1},isNonEmpty:function(e){return""===e?1:0}}),h={"120p,120p_1":[160,120,15,65],"120p_3":[120,120,15,50],"180p,180p_1":[320,180,15,140],"180p_3":[180,180,15,100],"180p_4":[240,180,15,120],"240p,240p_1":[320,240,15,200],"240p_3":[240,240,15,140],"240p_4":[424,240,15,220],"360p,360p_1":[640,360,15,400],"360p_3":[360,360,15,260],"360p_4":[640,360,30,600],"360p_6":[360,360,30,400],"360p_7":[480,360,15,320],"360p_8":[480,360,30,490],"360p_9":[640,360,15,800],"360p_10":[640,360,24,800],"360p_11":[640,360,24,1e3],"480p,480p_1":[640,480,15,500],"480p_2":[640,480,30,1e3],"480p_3":[480,480,15,400],"480p_4":[640,480,30,750],"480p_6":[480,480,30,600],"480p_8":[848,480,15,610],"480p_9":[848,480,30,930],"480p_10":[640,480,10,400],"720p,720p_1":[1280,720,15,1130],"720p_2":[1280,720,15,2080],"720p_3":[1280,720,30,1710],"720p_5":[960,720,15,910],"720p_6":[960,720,30,1380],"1080p,1080p_1":[1920,1080,15,2080],"1080p_2":[1920,1080,30,3e3],"1080p_3":[1920,1080,30,3150],"1080p_5":[1920,1080,60,4780],"1440p,1440p_1":[2560,1440,30,4850],"1440p_2":[2560,1440,60,7350],"4k,4k_1":[3840,2160,30,8910],"4k_3":[3840,2160,60,13500]},v=(a(38),s.a.Component,function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).validate=function(e){return a.setState({state:"",errorMsg:""}),g.isNonEmpty(e.trim())?(a.setState({errorMsg:"Cannot be empty!",state:"is-danger"}),!1):g.minLength(e.trim(),1)?(a.setState({errorMsg:"No shorter than 1!",state:"is-danger"}),!1):g.maxLength(e.trim(),16)?(a.setState({errorMsg:"No longer than 16!",state:"is-danger"}),!1):g.validChar(e.trim())?(a.setState({state:"is-danger",errorMsg:'Only capital or lower-case letter, number and "_" are permitted!'}),!1):(a.setState({state:"is-success"}),!0)},a.handleChange=function(e){var t=a.validate(e.target.value);a.props.onChange(e.target.value,t)},a.state={errorMsg:"",state:""},a}return Object(r.a)(n,[{key:"render",value:function(){var e="";switch(this.state.state){default:case"":e="";break;case"is-success":e=s.a.createElement("i",{className:"ag-icon ag-icon-valid"});break;case"is-danger":e=s.a.createElement("i",{className:"ag-icon ag-icon-invalid"})}return s.a.createElement("div",{className:"channel-wrapper control has-icons-left"},s.a.createElement("input",{onInput:this.handleChange,id:"channel",className:"ag-rounded input "+this.state.state,type:"text",placeholder:this.props.placeholder}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement("img",{src:a(40),alt:""})),s.a.createElement("span",{className:"validate-icon"},e),s.a.createElement("div",{className:"validate-msg"},this.state.errorMsg))}}]),n}(s.a.Component)),f=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleSelect=function(e){var t=e.label,a=e.value;n.setState({message:t,active:!1}),n.props.onChange(a)},n._options=[{label:"Agora Video Call",value:"avc",content:"One to one and group calls"},{label:"Agora Live",value:"al",content:"Enabling real-time interactions between the host and the audience"}],n.state={active:!1,message:"Agora Video Call"},n}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this._options.map(function(t,a){return s.a.createElement("div",{className:"dropdown-item",key:a,onClick:function(a){return e.handleSelect(t,a)}},s.a.createElement("p",null,t.label),s.a.createElement("hr",null),s.a.createElement("p",null,t.content))});return s.a.createElement("div",{className:this.state.active?"dropdown is-active":"dropdown"},s.a.createElement("div",{className:"dropdown-trigger",onClick:function(){return e.setState({active:!e.state.active})}},s.a.createElement("a",{id:"baseMode",className:"ag-rounded button","aria-haspopup":"true","aria-controls":"baseModeOptions"},s.a.createElement("span",{id:"baseOptionLabel"},this.state.message),s.a.createElement("span",{className:"icon is-small"},s.a.createElement("i",{className:"ag-icon ag-icon-arrow-down","aria-hidden":"true"})))),s.a.createElement("div",{className:"dropdown-menu",id:"baseModeOptions",role:"menu"},s.a.createElement("div",{className:"dropdown-content"},t)))}}]),a}(s.a.Component),b=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleRadio=function(e){n.props.onRadioChange(e.target.value)},n.handleSelect=function(e){n.props.onSelectChange(e.target.value)},n.state={active:!1},n}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=Object.entries(h).map(function(e,t){return s.a.createElement("option",{key:t,value:e[0].split(",")[0]},e[1][0],"x ",e[1][1],", ",e[1][2],"fps, ",e[1][3],"kbps")});return s.a.createElement("div",{className:this.state.active?"dropdown is-active":"dropdown"},s.a.createElement("div",{className:"dropdown-trigger",onClick:function(){return e.setState({active:!e.state.active})}},s.a.createElement("a",{id:"advancedProfile",className:"ag-rounded button","aria-haspopup":"true","aria-controls":"advancedOptions"},s.a.createElement("span",null,"Advanced"))),s.a.createElement("div",{className:"dropdown-menu",id:"advancedOptions",role:"menu"},s.a.createElement("div",{className:"dropdown-content"},s.a.createElement("div",{className:"dropdown-item"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"radio"},s.a.createElement("input",{value:"",type:"radio",name:"transcode",onChange:this.handleRadio}),s.a.createElement("span",null,"VP8-only")),s.a.createElement("label",{className:"radio"},s.a.createElement("input",{value:"interop",type:"radio",defaultChecked:!0,onChange:this.handleRadio,name:"transcode"}),s.a.createElement("span",null,"VP8 & H264")),s.a.createElement("label",{className:"radio"},s.a.createElement("input",{value:"h264_interop",type:"radio",onChange:this.handleRadio,name:"transcode"}),s.a.createElement("span",null,"H264-only")))),s.a.createElement("div",{className:"dropdown-item"},s.a.createElement("div",{className:"select is-rounded"},s.a.createElement("select",{onChange:this.handleSelect,defaultValue:"480p_4",id:"videoProfile",className:"ag-rounded is-clipped"},t))))))}}]),a}(s.a.Component),E=a(14),y=(a(41),a(26)),S="cb3ef8dc3b2e48b994fb3e826fb5ffcc",A=(a(44),function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).videoProfile="480p_4",n.channel=n.props.match.params.userId,n.transcode="interop",n.attendeeMode="video",n.baseMode="avc",n.appId=S,n.appId?(n.uid=void 0,n):Object(E.a)(n,alert("Get App ID first!"))}return Object(r.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s.a.createElement("div",{className:"wrapper meeting"},s.a.createElement("div",{className:"ag-header"},s.a.createElement("div",{className:"ag-header-msg"},"Room:\xa0",s.a.createElement("span",{id:"room-name"},this.channel))),s.a.createElement("div",{className:"ag-main"},s.a.createElement("div",{className:"ag-container"},s.a.createElement(y.a,{videoProfile:this.videoProfile,channel:this.channel,transcode:this.transcode,attendeeMode:this.attendeeMode,baseMode:this.baseMode,appId:this.appId,uid:this.uid}))))}}]),a}(s.a.Component)),N=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"full"},s.a.createElement(p.a,null,s.a.createElement(m.c,null,s.a.createElement(m.a,{path:"/:userId/:user",component:A}))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),a=t.length,n=new Array(a);a--;)n[a]=[t[a],e[t[a]]];return n});o.a.render(s.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[31,1,2]]]);
//# sourceMappingURL=main.c7e5c76d.chunk.js.map